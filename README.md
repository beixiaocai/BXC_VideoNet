# BXC_VideoNet - è§†é¢‘åˆ†ç±»æ·±åº¦å­¦ä¹ è®­ç»ƒæ¡†æ¶

<div align="center">

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![Python](https://img.shields.io/badge/python-3.8%2B-blue.svg)](https://www.python.org/)
[![PyTorch](https://img.shields.io/badge/pytorch-2.1.0-red.svg)](https://pytorch.org/)
[![Flask](https://img.shields.io/badge/flask-3.0.0-green.svg)](https://flask.palletsprojects.com/)

</div>

## ğŸ‘¨â€ğŸ’» ä½œè€…ä¿¡æ¯

- **ä½œè€…**ï¼šåŒ—å°èœ
- **å®˜ç½‘**ï¼šhttp://www.beixiaocai.com
- **é‚®ç®±**ï¼šbilibili_bxc@126.com
- **QQ**ï¼š1402990689
- **å¾®ä¿¡**ï¼šbilibili_bxc
- **å“”å“©å“”å“©**ï¼šhttps://space.bilibili.com/487906612
- **Gitee**ï¼šhttps://gitee.com/Vanishi/BXC_VideoNet
- **GitHub**ï¼šhttps://github.com/beixiaocai/BXC_VideoNet

## ğŸ“– é¡¹ç›®ç®€ä»‹

BXC_VideoNet æ˜¯ä¸€ä¸ªé¢å‘è§†é¢‘ç‰‡æ®µåˆ†ç±»çš„æ·±åº¦å­¦ä¹ è®­ç»ƒæ¡†æ¶ï¼Œæä¾›å®Œæ•´çš„æ¨¡å‹è®­ç»ƒã€æµ‹è¯•ã€éƒ¨ç½²è§£å†³æ–¹æ¡ˆã€‚é¡¹ç›®åŒ…å«ï¼š

- ğŸ¯ **å‘½ä»¤è¡Œè®­ç»ƒå·¥å…·**ï¼šä¼ ç»Ÿçš„ Python è„šæœ¬è®­ç»ƒæ–¹å¼
- ğŸŒ **Web ç®¡ç†åå°**ï¼šåŸºäº Flask çš„å¯è§†åŒ–è®­ç»ƒç®¡ç†å¹³å°
- ğŸš€ **å¤šå¹³å°éƒ¨ç½²**ï¼šæ”¯æŒ ONNXã€OpenVINOã€TensorRT æ¨¡å‹å¯¼å‡º
- ğŸ’¡ **è½»é‡çº§æ¨¡å‹**ï¼šé«˜æ•ˆçš„ 3D å·ç§¯ç¥ç»ç½‘ç»œæ¶æ„

## âœ¨ ä¸»è¦ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- âœ… è§†é¢‘åˆ†ç±»æ¨¡å‹è®­ç»ƒï¼ˆåŸºäº PyTorchï¼‰
- âœ… UCF50/UCF101 æ•°æ®é›†æ”¯æŒ
- âœ… æ•°æ®é›†è‡ªåŠ¨åˆ†å‰²ï¼ˆtrain/valï¼‰
- âœ… æ¨¡å‹å¯¼å‡ºï¼ˆPyTorch â†’ ONNX â†’ OpenVINOï¼‰
- âœ… å®æ—¶è®­ç»ƒè¿›åº¦ç›‘æ§
- âœ… æ–­ç‚¹ç»­è®­æ”¯æŒ

### Web ç®¡ç†åå°ç‰¹è‰²
- ğŸ¨ **ç°ä»£åŒ– UI**ï¼šæ¸å˜è‰²è®¾è®¡ï¼Œå“åº”å¼å¸ƒå±€
- ğŸ“ **æ•°æ®é›†ç®¡ç†**ï¼šæ‹–æ‹½ä¸Šä¼ ã€ç±»åˆ«ç®¡ç†ã€è‡ªåŠ¨åˆ†å‰²
- ğŸš€ **è®­ç»ƒç›‘æ§**ï¼šå®æ—¶æ˜¾ç¤ºæŸå¤±ã€å‡†ç¡®ç‡ã€è¿›åº¦æ¡
- ğŸ§ª **æ¨¡å‹æµ‹è¯•**ï¼šä¸Šä¼ è§†é¢‘é¢„æµ‹ï¼ŒTop-5 ç»“æœå±•ç¤º
- ğŸ”„ **æ¨¡å‹è½¬æ¢**ï¼šä¸€é”®è½¬æ¢ ONNX/OpenVINO æ ¼å¼
- ğŸ’¾ **é›¶ç¬¬ä¸‰æ–¹åº“**ï¼šçº¯åŸç”Ÿ HTML/CSS/JavaScript å®ç°

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **æ·±åº¦å­¦ä¹ **ï¼šPyTorch 2.1.0 + torchvision 0.16.0
- **Web æ¡†æ¶**ï¼šFlask 3.0.0
- **æ¨¡å‹å¯¼å‡º**ï¼šONNX 1.16.1 + OpenVINO 2024.3.0
- **è§†é¢‘å¤„ç†**ï¼šOpenCV 4.8.0.74
- **æ¨ç†åŠ é€Ÿ**ï¼šONNX Runtime 1.19.0

## ğŸ“¦ å®‰è£…æŒ‡å—

### ç¯å¢ƒè¦æ±‚

- **Python ç‰ˆæœ¬**ï¼š
  - Windowsï¼šPython 3.10ï¼ˆæ¨èï¼‰
  - Linuxï¼šPython 3.8ï¼ˆæ¨èï¼‰
- **æ“ä½œç³»ç»Ÿ**ï¼šWindows 10/11ã€Ubuntu 18.04+
- **GPUï¼ˆå¯é€‰ï¼‰**ï¼šNVIDIA GPU + CUDA 12.1

### 1ï¸âƒ£ åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ

> âš ï¸ **é‡è¦**ï¼šå¼ºçƒˆå»ºè®®ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒï¼Œé¿å…ä¾èµ–å†²çª

#### Windows ç³»ç»Ÿ

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
venv\Scripts\activate

# æ›´æ–° pip
python -m pip install --upgrade pip -i https://pypi.tuna.tsinghua.edu.cn/simple
```

#### Linux ç³»ç»Ÿ

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate

# æ›´æ–° pip
python -m pip install --upgrade pip -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### 2ï¸âƒ£ å®‰è£…ä¾èµ–åº“

#### å®‰è£…åŸºç¡€ä¾èµ–

```bash
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

#### å®‰è£… PyTorch

**CPU ç‰ˆæœ¬**ï¼ˆé€‚åˆå­¦ä¹ æµ‹è¯•ï¼‰ï¼š

```bash
pip install torch==2.1.0 torchvision==0.16.0 torchaudio==2.1.0 -i https://pypi.tuna.tsinghua.edu.cn/simple
```

**GPU ç‰ˆæœ¬**ï¼ˆCUDA 12.1ï¼Œæ¨èè®­ç»ƒä½¿ç”¨ï¼‰ï¼š

```bash
pip install torch==2.1.0 torchvision==0.16.0 torchaudio==2.1.0 --index-url https://download.pytorch.org/whl/cu121
```

> ğŸ“Œ **æ³¨æ„**ï¼šè¯·æ ¹æ®ä½ çš„ CUDA ç‰ˆæœ¬é€‰æ‹©å¯¹åº”çš„ PyTorch ç‰ˆæœ¬ï¼Œè®¿é—® [PyTorch å®˜ç½‘](https://pytorch.org/) æŸ¥çœ‹æ›´å¤šç‰ˆæœ¬ã€‚

### 3ï¸âƒ£ éªŒè¯å®‰è£…

```bash
python -c "import torch; print('PyTorchç‰ˆæœ¬:', torch.__version__); print('CUDAå¯ç”¨:', torch.cuda.is_available())"
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šWeb ç®¡ç†åå°ï¼ˆæ¨èï¼‰

#### 1. å¯åŠ¨ Web æœåŠ¡å™¨

```bash
python app.py
```

#### 2. è®¿é—®ç®¡ç†åå°

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼š`http://127.0.0.1:5000`

#### 3. ä½¿ç”¨æµç¨‹

1. **ğŸ“ æ•°æ®é›†ç®¡ç†**ï¼š
   - åˆ›å»ºç±»åˆ«æ–‡ä»¶å¤¹ï¼ˆå¦‚ Basketballã€Dancingï¼‰
   - æ‹–æ‹½ä¸Šä¼ è§†é¢‘åˆ°å¯¹åº”ç±»åˆ«
   - è®¾ç½®æ¯”ä¾‹åˆ†å‰²è®­ç»ƒé›†/éªŒè¯é›†ï¼ˆé»˜è®¤ 8:2ï¼‰

2. **ğŸš€ æ¨¡å‹è®­ç»ƒ**ï¼š
   - é…ç½®è®­ç»ƒå‚æ•°ï¼ˆè½®æ•°ã€æ‰¹æ¬¡å¤§å°ã€å­¦ä¹ ç‡ï¼‰
   - å¯é€‰é¢„è®­ç»ƒæ¨¡å‹ï¼ˆæ–­ç‚¹ç»­è®­ï¼‰
   - å®æ—¶æŸ¥çœ‹è®­ç»ƒè¿›åº¦å’Œæ—¥å¿—

3. **ğŸ§ª æ¨¡å‹æµ‹è¯•**ï¼š
   - é€‰æ‹©è®­ç»ƒå¥½çš„æ¨¡å‹
   - ä¸Šä¼ æµ‹è¯•è§†é¢‘
   - æŸ¥çœ‹é¢„æµ‹ç»“æœå’Œ Top-5 æ¦‚ç‡

4. **ğŸ”„ æ¨¡å‹è½¬æ¢**ï¼š
   - é€‰æ‹©è®­ç»ƒæ¨¡å‹
   - è½¬æ¢ä¸º ONNX æ ¼å¼ï¼ˆæ”¯æŒåŠ¨æ€è¾“å…¥ï¼‰
   - è½¬æ¢ä¸º OpenVINO æ ¼å¼ï¼ˆIntel å¹³å°ä¼˜åŒ–ï¼‰

### æ–¹å¼äºŒï¼šå‘½ä»¤è¡Œè®­ç»ƒ

#### 1. å‡†å¤‡æ•°æ®é›†

æ•°æ®é›†ç›®å½•ç»“æ„ï¼š

```
UCF50/
â”œâ”€â”€ train/
â”‚   â”œâ”€â”€ BaseballPitch/
â”‚   â”‚   â”œâ”€â”€ v_BaseballPitch_g01_c01.avi
â”‚   â”‚   â”œâ”€â”€ v_BaseballPitch_g01_c02.avi
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ Basketball/
â”‚   â”‚   â”œâ”€â”€ v_Basketball_g01_c01.avi
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ ...
â””â”€â”€ val/
    â”œâ”€â”€ BaseballPitch/
    â”‚   â”œâ”€â”€ v_BaseballPitch_g01_c03.avi
    â”‚   â””â”€â”€ ...
    â””â”€â”€ ...
```

#### 2. è½¬æ¢ UCF æ•°æ®é›†æ ¼å¼

å¦‚æœä½ ä¸‹è½½çš„æ˜¯åŸå§‹ UCF50/UCF101 æ•°æ®é›†ï¼š

```bash
python split_ucf.py
```

#### 3. è®­ç»ƒæ¨¡å‹

```bash
python train.py
```

#### 4. æµ‹è¯•æ¨¡å‹

```bash
python test.py
```

#### 5. å¯¼å‡ºæ¨¡å‹

**å¯¼å‡ºä¸º ONNX æ ¼å¼**ï¼š

```bash
python export2onnx.py
```

**è½¬æ¢ä¸º OpenVINO æ ¼å¼**ï¼š

```bash
mo --input_model best_model.onnx --output_dir best_model_openvino_model
```

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
BXC_VideoNet/
â”œâ”€â”€ app.py                      # Web æœåŠ¡å™¨ä¸»ç¨‹åº
â”œâ”€â”€ train.py                    # å‘½ä»¤è¡Œè®­ç»ƒè„šæœ¬
â”œâ”€â”€ test.py                     # æ¨¡å‹æµ‹è¯•è„šæœ¬
â”œâ”€â”€ export2onnx.py              # ONNX å¯¼å‡ºè„šæœ¬
â”œâ”€â”€ split_ucf.py                # UCF æ•°æ®é›†åˆ†å‰²è„šæœ¬
â”œâ”€â”€ model.py                    # æ¨¡å‹æ¶æ„å®šä¹‰
â”œâ”€â”€ dataset.py                  # æ•°æ®é›†åŠ è½½æ¨¡å—ï¼ˆæ”¯æŒè§†é¢‘å’Œå›¾åƒï¼‰
â”‚   â”œâ”€â”€ VideoDatasetVideo      # ä»è§†é¢‘æ–‡ä»¶ç›´æ¥è¯»å–ï¼ˆæ”¯æŒ3ç§é‡‡æ ·ç­–ç•¥ï¼‰
â”‚   â””â”€â”€ VideoDatasetImage      # ä»å›¾ç‰‡åºåˆ—è¯»å–
â”œâ”€â”€ requirements.txt            # ä¾èµ–åº“åˆ—è¡¨
â”œâ”€â”€ README.md                   # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ VIDEO_SAMPLING_STRATEGIES.md # è§†é¢‘é‡‡æ ·ç­–ç•¥è¯¦ç»†è¯´æ˜
â”œâ”€â”€ templates/                  # Web é¡µé¢æ¨¡æ¿
â”‚   â”œâ”€â”€ base.html              # åŸºç¡€æ¨¡æ¿
â”‚   â”œâ”€â”€ index.html             # æ•°æ®é›†ç®¡ç†é¡µé¢
â”‚   â”œâ”€â”€ train.html             # è®­ç»ƒé¡µé¢
â”‚   â”œâ”€â”€ test.html              # æµ‹è¯•é¡µé¢
â”‚   â””â”€â”€ convert.html           # æ¨¡å‹è½¬æ¢é¡µé¢
â”œâ”€â”€ web_data/                   # Web æ•°æ®ç›®å½•ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚   â”œâ”€â”€ uploads/               # ä¸Šä¼ çš„è§†é¢‘
â”‚   â”œâ”€â”€ dataset/               # åˆ†å‰²åçš„æ•°æ®é›†
â”‚   â”œâ”€â”€ models/                # ä¿å­˜çš„æ¨¡å‹
â”‚   â””â”€â”€ config.json            # é…ç½®æ–‡ä»¶
â”œâ”€â”€ models_20251012001_ucf50/  # é¢„è®­ç»ƒæ¨¡å‹ï¼ˆå¯é€‰ï¼‰
â””â”€â”€ test/                      # C++ æ¨ç†ç¤ºä¾‹
    â”œâ”€â”€ onnx_inference.py      # ONNX Runtime æ¨ç†
    â”œâ”€â”€ openvino_inference/    # OpenVINO C++ æ¨ç†
    â””â”€â”€ tensorrt_inference/    # TensorRT C++ æ¨ç†
```

## ğŸ’¡ ä½¿ç”¨æŒ‡å—

### è§†é¢‘é‡‡æ ·ç­–ç•¥è¯´æ˜ â­ é‡è¦

é¡¹ç›®æä¾›äº†ä¸‰ç§æ™ºèƒ½è§†é¢‘é‡‡æ ·ç­–ç•¥ï¼Œå¯æ˜¾è‘—æå‡æ¨¡å‹æ€§èƒ½ã€‚æ‰€æœ‰ç­–ç•¥éƒ½ä¼šé‡‡æ ·å›ºå®šæ•°é‡çš„å¸§ï¼ˆé»˜è®¤16å¸§ï¼Œå¯é…ç½®ï¼‰ã€‚

#### ğŸ“Š é‡‡æ ·ç­–ç•¥å¯¹æ¯”

| ç­–ç•¥ | é€‚ç”¨åœºæ™¯ | ä¸»è¦ä¼˜åŠ¿ | æ•°æ®å¢å¼º |
|------|---------|---------|----------|
| **uniform** | éªŒè¯é›†/æµ‹è¯•é›† | ç¨³å®šå¯å¤ç° | æ—  |
| **random_segment** â­ | è®­ç»ƒé›†ï¼ˆæ¨èï¼‰ | æ—¶é—´å¢å¼ºï¼Œæå‡æ³›åŒ– | å¼º |
| **dense** | é•¿è§†é¢‘/å¤æ‚åŠ¨ä½œ | ç»†ç²’åº¦è¦†ç›– | ä¸­ç­‰ |

#### ğŸ¯ ç­–ç•¥è¯¦è§£

**1. uniform - å‡åŒ€é‡‡æ ·**
- åœ¨æ•´ä¸ªè§†é¢‘ä¸Šå‡åŒ€é‡‡æ ·
- æ¯æ¬¡é‡‡æ ·ç»“æœå®Œå…¨ä¸€è‡´
- é€‚åˆéªŒè¯é›†å’Œæµ‹è¯•é›†

**2. random_segment - éšæœºç‰‡æ®µé‡‡æ ·**ï¼ˆæ¨èç”¨äºè®­ç»ƒï¼‰
- æ¯ä¸ªepochéšæœºé€‰æ‹©è§†é¢‘çš„ä¸åŒæ—¶é—´æ®µ
- ç­‰æ•ˆäº2-3å€æ•°æ®å¢å¼º
- é¢„æœŸå‡†ç¡®ç‡æå‡ **+3% ~ +8%**
- è®­ç»ƒé›†é»˜è®¤å¯ç”¨æ­¤ç­–ç•¥

**3. dense - å¯†é›†åˆ†æ®µé‡‡æ ·**
- å°†è§†é¢‘åˆ†æ®µï¼Œæ¯æ®µé‡‡æ ·ä¸€å¸§
- é€‚åˆè¶…è¿‡300å¸§çš„é•¿è§†é¢‘
- è®­ç»ƒæ—¶æ¯æ®µéšæœºé‡‡æ ·ï¼ŒéªŒè¯æ—¶å–ä¸­é—´å¸§

#### ğŸ’» ä½¿ç”¨ç¤ºä¾‹

```python
from dataset import VideoDatasetVideo
from torchvision import transforms

# è®­ç»ƒé›† - ä½¿ç”¨random_segmentç­–ç•¥ï¼ˆæ•°æ®å¢å¼ºï¼‰
train_dataset = VideoDatasetVideo(
    phase='train',
    root_dir='data/train',
    transform=train_transforms,
    num_frames=16,                     # é‡‡æ ·å¸§æ•°ï¼ˆå¯é…ç½®ï¼‰
    sampling_strategy='random_segment'  # éšæœºç‰‡æ®µé‡‡æ ·
)

# éªŒè¯é›† - ä½¿ç”¨uniformç­–ç•¥ï¼ˆç¨³å®šè¯„ä¼°ï¼‰
val_dataset = VideoDatasetVideo(
    phase='val',
    root_dir='data/val',
    transform=val_transforms,
    num_frames=16,                     # é‡‡æ ·å¸§æ•°
    sampling_strategy='uniform'         # å‡åŒ€é‡‡æ ·
)

# é•¿è§†é¢‘ - ä½¿ç”¨denseç­–ç•¥ + æ›´å¤šå¸§
long_video_dataset = VideoDatasetVideo(
    phase='train',
    root_dir='data/long_videos',
    transform=train_transforms,
    num_frames=32,                     # å¢åŠ é‡‡æ ·å¸§æ•°
    sampling_strategy='dense'           # å¯†é›†é‡‡æ ·
)
```

> ğŸ“– **è¯¦ç»†è¯´æ˜**ï¼šæŸ¥çœ‹ [VIDEO_SAMPLING_STRATEGIES.md](VIDEO_SAMPLING_STRATEGIES.md) äº†è§£é‡‡æ ·ç­–ç•¥çš„åŸç†ã€æ€§èƒ½å¯¹æ¯”å’Œæœ€ä½³å®è·µã€‚

### æ•°æ®é›†åŠ è½½æ¨¡å—è¯´æ˜

é¡¹ç›®æ”¯æŒä¸¤ç§æ•°æ®åŠ è½½æ–¹å¼ï¼ˆä½äº `dataset.py`ï¼‰ï¼š

1. **VideoDatasetVideo**ï¼šç›´æ¥ä»è§†é¢‘æ–‡ä»¶è¯»å–
   - æ”¯æŒä¸‰ç§æ™ºèƒ½é‡‡æ ·ç­–ç•¥
   - æ”¯æŒæ ¼å¼ï¼š.mp4ã€.aviã€.mov
   - é€‚åˆï¼šåŸå§‹è§†é¢‘æ–‡ä»¶æ•°æ®é›†ï¼ˆå¦‚ UCF50/UCF101ï¼‰

2. **VideoDatasetImage**ï¼šä»å›¾ç‰‡åºåˆ—è¯»å–
   - ä»è§†é¢‘å¸§å›¾ç‰‡æ–‡ä»¶å¤¹è¯»å–
   - æ”¯æŒæ ¼å¼ï¼š.jpgã€.jpegã€.png
   - é€‚åˆï¼šå·²æå–å¸§çš„æ•°æ®é›†

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# å¯¼å…¥æ•°æ®é›†ç±»
from dataset import VideoDatasetVideo, VideoDatasetImage

# ä½¿ç”¨è§†é¢‘æ–‡ä»¶æ•°æ®é›†ï¼ˆæ¨èï¼‰
dataset = VideoDatasetVideo('train', 'path/to/train', 
                           transform=data_transforms['train'],
                           num_frames=16,
                           sampling_strategy='random_segment')

# æˆ–ä½¿ç”¨å›¾ç‰‡åºåˆ—æ•°æ®é›†
dataset = VideoDatasetImage('train', 'path/to/frames', 
                           transform=data_transforms['train'])
```

### Web ç®¡ç†åå°è¯¦ç»†è¯´æ˜

#### ğŸ“ æ•°æ®é›†ç®¡ç†

1. **åˆ›å»ºç±»åˆ«æ–‡ä»¶å¤¹**ï¼š
   - è¾“å…¥ç±»åˆ«åç§°ï¼ˆå¦‚ Basketballã€Dancingã€Runningï¼‰
   - ç‚¹å‡»"åˆ›å»ºç±»åˆ«"æŒ‰é’®
   - ç±»åˆ«å¡ç‰‡ä¼šæ˜¾ç¤ºåœ¨é¡µé¢ä¸Š

2. **ä¸Šä¼ è§†é¢‘**ï¼š
   - ç‚¹å‡»ç±»åˆ«å¡ç‰‡é€‰ä¸­ï¼ˆä¼šé«˜äº®æ˜¾ç¤ºï¼‰
   - æ‹–æ‹½æˆ–ç‚¹å‡»ä¸Šä¼ è§†é¢‘æ–‡ä»¶
   - æ”¯æŒå¤šæ–‡ä»¶å¹¶è¡Œä¸Šä¼ 
   - æ”¯æŒæ ¼å¼ï¼š.mp4ã€.aviã€.mov
   - å•æ–‡ä»¶æœ€å¤§ 500MB

3. **åˆ†å‰²æ•°æ®é›†**ï¼š
   - è°ƒæ•´è®­ç»ƒé›†æ¯”ä¾‹æ»‘å—ï¼ˆé»˜è®¤ 80%ï¼‰
   - è®¾ç½®éšæœºç§å­ï¼ˆä¿è¯å¯é‡å¤æ€§ï¼‰
   - ç‚¹å‡»"å¼€å§‹åˆ†å‰²"æŒ‰é’®
   - ç³»ç»Ÿè‡ªåŠ¨å°†è§†é¢‘å¤åˆ¶åˆ° train/val ç›®å½•

4. **æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯**ï¼š
   - é¡µé¢é¡¶éƒ¨æ˜¾ç¤ºè®­ç»ƒé›†/éªŒè¯é›†æ•°é‡
   - ç±»åˆ«æ€»æ•°å’Œæ¯ç±»è§†é¢‘æ•°é‡
   - å®æ—¶æ›´æ–°ç»Ÿè®¡æ•°æ®

#### ğŸš€ æ¨¡å‹è®­ç»ƒ

**è®­ç»ƒå‚æ•°è¯´æ˜**ï¼š

- **è®­ç»ƒè½®æ•° (Epochs)**ï¼š
  - å°æ•°æ®é›†ï¼š50-100
  - ä¸­ç­‰æ•°æ®é›†ï¼š100-200
  - å¤§æ•°æ®é›†ï¼š200-300

- **æ‰¹æ¬¡å¤§å° (Batch Size)**ï¼š
  - GPU æ˜¾å­˜ 4GBï¼š4-8
  - GPU æ˜¾å­˜ 8GBï¼š8-16
  - GPU æ˜¾å­˜ 12GB+ï¼š16-32
  - CPU è®­ç»ƒï¼š2-4

- **å­¦ä¹ ç‡ (Learning Rate)**ï¼š
  - ä»å¤´è®­ç»ƒï¼š0.0005-0.001
  - è¿ç§»å­¦ä¹ ï¼š0.0001-0.0005

- **é¢„è®­ç»ƒæ¨¡å‹**ï¼š
  - ä»å¤´è®­ç»ƒï¼šä¸é€‰æ‹©
  - æ–­ç‚¹ç»­è®­ï¼šé€‰æ‹© latest_model.pth
  - è¿ç§»å­¦ä¹ ï¼šé€‰æ‹©å…¶ä»–è®­ç»ƒå¥½çš„æ¨¡å‹

**è®­ç»ƒç›‘æ§**ï¼š

- å®æ—¶æ˜¾ç¤ºå½“å‰è½®æ¬¡è¿›åº¦æ¡
- è®­ç»ƒé›†æŸå¤±å’Œå‡†ç¡®ç‡
- éªŒè¯é›†æŸå¤±å’Œå‡†ç¡®ç‡
- å†å²æœ€ä½³éªŒè¯å‡†ç¡®ç‡
- è¯¦ç»†è®­ç»ƒæ—¥å¿—æ»šåŠ¨æ˜¾ç¤º

**æ¨¡å‹ä¿å­˜**ï¼š

- æœ€ä½³æ¨¡å‹ï¼š`best_model_epoch{è½®æ¬¡}_acc{å‡†ç¡®ç‡}.pth`
- æœ€æ–°æ¨¡å‹ï¼š`latest_model.pth`ï¼ˆæ¯è½®æ›´æ–°ï¼‰
- ä¿å­˜ä½ç½®ï¼š`web_data/models/`

#### ğŸ§ª æ¨¡å‹æµ‹è¯•

1. **é€‰æ‹©æ¨¡å‹**ï¼šä»ä¸‹æ‹‰åˆ—è¡¨é€‰æ‹©å·²è®­ç»ƒæ¨¡å‹
2. **ä¸Šä¼ æµ‹è¯•è§†é¢‘**ï¼šæ‹–æ‹½æˆ–ç‚¹å‡»ä¸Šä¼ 
3. **æŸ¥çœ‹é¢„æµ‹ç»“æœ**ï¼š
   - é¢„æµ‹ç±»åˆ«
   - ç½®ä¿¡åº¦ï¼ˆç™¾åˆ†æ¯”ï¼‰
   - Top-5 é¢„æµ‹æ¦‚ç‡åˆ†å¸ƒ
4. **æµ‹è¯•å†å²**ï¼šä¿ç•™æœ€è¿‘ 10 æ¬¡æµ‹è¯•è®°å½•

#### ğŸ”„ æ¨¡å‹è½¬æ¢

**ONNX æ ¼å¼è½¬æ¢**ï¼š

- âœ… è·¨å¹³å°éƒ¨ç½²ï¼ˆWindowsã€Linuxã€ARMï¼‰
- âœ… å¯é€‰åŠ¨æ€è¾“å…¥ç»´åº¦
- âœ… è‡ªåŠ¨æ¨¡å‹éªŒè¯
- ğŸ“¦ ç”Ÿæˆ `.onnx` æ–‡ä»¶

**OpenVINO æ ¼å¼è½¬æ¢**ï¼š

- âœ… Intel CPU/GPU ä¼˜åŒ–
- âœ… æ¨ç†æ€§èƒ½æå‡ 2-5 å€
- âœ… æ”¯æŒè¾¹ç¼˜è®¾å¤‡éƒ¨ç½²
- ğŸ“¦ ç”Ÿæˆ `.xml` å’Œ `.bin` æ–‡ä»¶

### è®­ç»ƒä¼˜åŒ–å»ºè®®

#### æ•°æ®é›†å‡†å¤‡

1. **æ•°é‡è¦æ±‚**ï¼š
   - æ¯ä¸ªç±»åˆ«è‡³å°‘ 20-50 ä¸ªè§†é¢‘
   - æ€»æ ·æœ¬æ•°å»ºè®® 500+ ä»¥ä¸Š

2. **è´¨é‡è¦æ±‚**ï¼š
   - è§†é¢‘æ¸…æ™°ã€ç¨³å®šã€å…‰çº¿å……è¶³
   - é¿å…è¿‡åº¦æ™ƒåŠ¨å’Œæ¨¡ç³Š
   - èƒŒæ™¯å°½é‡ç®€æ´

3. **æ—¶é•¿å»ºè®®**ï¼š
   - 3-10 ç§’æœ€ä½³ï¼ˆç³»ç»Ÿæ”¯æŒçµæ´»é…ç½®é‡‡æ ·å¸§æ•°ï¼‰
   - çŸ­è§†é¢‘ï¼šé‡‡æ ·16å¸§
   - é•¿è§†é¢‘ï¼ˆ>300å¸§ï¼‰ï¼šé‡‡æ ·32-64å¸§ï¼Œä½¿ç”¨denseç­–ç•¥

4. **ç±»åˆ«å¹³è¡¡**ï¼š
   - å„ç±»åˆ«è§†é¢‘æ•°é‡å°½é‡æ¥è¿‘
   - é¿å…æ•°æ®å€¾æ–œ

#### è§£å†³è¿‡æ‹Ÿåˆ

**ç°è±¡**ï¼šè®­ç»ƒå‡†ç¡®ç‡é«˜ï¼ŒéªŒè¯å‡†ç¡®ç‡ä½

**è§£å†³æ–¹æ¡ˆ**ï¼š
- âœ… **å¯ç”¨random_segmenté‡‡æ ·ç­–ç•¥**ï¼ˆæ•°æ®å¢å¼ºï¼Œæ¨èï¼‰
- å‡å°‘è®­ç»ƒè½®æ•°ï¼ˆEarly Stoppingï¼‰
- æ”¶é›†æ›´å¤šè®­ç»ƒæ•°æ®
- ä½¿ç”¨æ•°æ®å¢å¼º
- é™ä½æ¨¡å‹å¤æ‚åº¦

#### è§£å†³æ¬ æ‹Ÿåˆ

**ç°è±¡**ï¼šè®­ç»ƒå’ŒéªŒè¯å‡†ç¡®ç‡éƒ½ä½

**è§£å†³æ–¹æ¡ˆ**ï¼š
- å¢åŠ è®­ç»ƒè½®æ•°
- æé«˜å­¦ä¹ ç‡
- æ£€æŸ¥æ•°æ®è´¨é‡
- å¢åŠ æ¨¡å‹å¤æ‚åº¦

## ğŸ“Š æ•°æ®é›†ä¸‹è½½

### å®˜æ–¹æ•°æ®é›†

- **UCF101**ï¼ˆ101 ç±»åŠ¨ä½œè¯†åˆ«ï¼‰ï¼š
  - å®˜ç½‘ï¼šhttps://www.crcv.ucf.edu/data/UCF101.php
  - æ ·æœ¬æ•°ï¼š13,320 ä¸ªè§†é¢‘
  - å¤§å°ï¼š~6.5GB

- **UCF50**ï¼ˆ50 ç±»åŠ¨ä½œè¯†åˆ«ï¼‰ï¼š
  - å®˜ç½‘ï¼šhttps://www.crcv.ucf.edu/data/UCF50.php
  - æ ·æœ¬æ•°ï¼š6,676 ä¸ªè§†é¢‘
  - å¤§å°ï¼š~3.2GB

### æ•°æ®é›†ç±»åˆ«ç¤ºä¾‹

```
BaseballPitchã€Basketballã€BenchPressã€Bikingã€Billiardsã€
BreastStrokeã€CleanAndJerkã€Divingã€Drummingã€Fencingã€
GolfSwingã€HighJumpã€HorseRaceã€HorseRidingã€HulaHoopã€
JavelinThrowã€JugglingBallsã€JumpingJackã€JumpRopeã€Kayaking...
```

## â“ å¸¸è§é—®é¢˜

### Q1: ä¸Šä¼ è§†é¢‘å¤±è´¥ï¼Ÿ

**å¯èƒ½åŸå› **ï¼š
- âŒ æ–‡ä»¶æ ¼å¼ä¸æ”¯æŒï¼ˆä»…æ”¯æŒ .mp4ã€.aviã€.movï¼‰
- âŒ æ–‡ä»¶å¤§å°è¶…è¿‡ 500MB
- âŒ ç£ç›˜ç©ºé—´ä¸è¶³
- âŒ æœªé€‰æ‹©ç›®æ ‡ç±»åˆ«

**è§£å†³æ–¹æ¡ˆ**ï¼š
- âœ… æ£€æŸ¥æ–‡ä»¶æ ¼å¼å’Œå¤§å°
- âœ… æ¸…ç†ç£ç›˜ç©ºé—´
- âœ… å…ˆç‚¹å‡»é€‰ä¸­ç±»åˆ«å¡ç‰‡

### Q2: è®­ç»ƒæ—¶æ˜¾å­˜ä¸è¶³ï¼ˆCUDA Out of Memoryï¼‰ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼š
- é™ä½ Batch Sizeï¼ˆå¦‚ä» 16 é™åˆ° 8 æˆ– 4ï¼‰
- å…³é—­å…¶ä»–å ç”¨ GPU çš„ç¨‹åº
- ä½¿ç”¨ CPU è®­ç»ƒï¼ˆé€Ÿåº¦è¾ƒæ…¢ï¼‰

### Q3: è®­ç»ƒé€Ÿåº¦å¾ˆæ…¢ï¼Ÿ

**æ£€æŸ¥é¡¹**ï¼š
- æ˜¯å¦ä½¿ç”¨äº† GPUï¼ˆæŸ¥çœ‹è®­ç»ƒæ—¥å¿—ä¸­çš„è®¾å¤‡ä¿¡æ¯ï¼‰
- æ•°æ®åŠ è½½æ˜¯å¦æˆä¸ºç“¶é¢ˆï¼ˆè°ƒæ•´ num_workersï¼‰
- æ‰¹æ¬¡å¤§å°æ˜¯å¦è¿‡å°

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨ GPU è®­ç»ƒï¼ˆæé€Ÿ 10-50 å€ï¼‰
- å¢åŠ æ‰¹æ¬¡å¤§å°
- ä½¿ç”¨ SSD ç¡¬ç›˜å­˜å‚¨æ•°æ®

### Q4: å¦‚ä½•æ–­ç‚¹ç»­è®­ï¼Ÿ

1. åœ¨è®­ç»ƒé¡µé¢é€‰æ‹©é¢„è®­ç»ƒæ¨¡å‹
2. é€‰æ‹© `latest_model.pth`ï¼ˆæœ€æ–°ä¿å­˜çš„æ¨¡å‹ï¼‰
3. é…ç½®è®­ç»ƒå‚æ•°ï¼ˆå¯ä»¥è°ƒæ•´å­¦ä¹ ç‡ç­‰ï¼‰
4. ç‚¹å‡»å¼€å§‹è®­ç»ƒï¼Œç³»ç»Ÿä¼šä»ä¸Šæ¬¡çŠ¶æ€ç»§ç»­

### Q5: æ¨¡å‹è½¬æ¢å¤±è´¥ï¼Ÿ

**ONNX è½¬æ¢å¤±è´¥**ï¼š
- æ£€æŸ¥æ¨¡å‹æ–‡ä»¶æ˜¯å¦å®Œæ•´
- ç¡®è®¤å·²å®‰è£… `onnx` åº“
- æŸ¥çœ‹æ—¥å¿—ä¸­çš„è¯¦ç»†é”™è¯¯ä¿¡æ¯

**OpenVINO è½¬æ¢å¤±è´¥**ï¼š
- ç¡®è®¤å·²å®‰è£… `openvino-dev`
- æ£€æŸ¥è™šæ‹Ÿç¯å¢ƒæ˜¯å¦æ¿€æ´»
- æŸ¥çœ‹æ˜¯å¦æœ‰æƒé™é—®é¢˜

### Q6: Web é¡µé¢æ— æ³•è®¿é—®ï¼Ÿ

**æ£€æŸ¥é¡¹**ï¼š
- Flask æœåŠ¡æ˜¯å¦æ­£å¸¸å¯åŠ¨
- æ˜¯å¦æœ‰å…¶ä»–ç¨‹åºå ç”¨ 5000 ç«¯å£
- é˜²ç«å¢™æ˜¯å¦é˜»æ­¢è®¿é—®

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -ano | findstr :5000  # Windows
lsof -i :5000                  # Linux

# æ›´æ¢ç«¯å£å¯åŠ¨
# ä¿®æ”¹ app.py æœ€åä¸€è¡Œçš„ port å‚æ•°
app.run(debug=True, host='0.0.0.0', port=8080)
```

## ğŸ”§ é«˜çº§é…ç½®

### ä¿®æ”¹æ¨¡å‹æ¶æ„

ç¼–è¾‘ `model.py` æ–‡ä»¶ä¸­çš„ `VideoNetModel` ç±»ï¼š

```python
class VideoNetModel(nn.Module):
    def __init__(self, num_classes=50):
        super(VideoNetModel, self).__init__()
        # ä¿®æ”¹ç½‘ç»œå±‚é…ç½®
        # ...
```

### è°ƒæ•´æ•°æ®å¢å¼º

ç¼–è¾‘ `train.py` æˆ– `app.py` ä¸­çš„æ•°æ®å¢å¼ºé…ç½®ï¼š

```python
# åœ¨ train.py æˆ– app.py ä¸­é…ç½®æ•°æ®å¢å¼º
data_transforms = {
    'train': transforms.Compose([
        transforms.RandomResizedCrop(224, scale=(0.8, 1.0)),
        transforms.RandomHorizontalFlip(),
        transforms.RandomVerticalFlip(p=0.2),
        transforms.RandomRotation(15),
        transforms.ColorJitter(brightness=0.2, contrast=0.2),
        transforms.ToTensor(),
        transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
    ])
}
```

### é…ç½®è§†é¢‘é‡‡æ ·ç­–ç•¥

åœ¨åˆ›å»ºæ•°æ®é›†æ—¶æŒ‡å®šé‡‡æ ·ç­–ç•¥ï¼š

```python
from dataset import VideoDatasetVideo

# ç¤ºä¾‹1ï¼šæ ‡å‡†é…ç½®ï¼ˆ16å¸§ + random_segmentï¼‰
train_dataset = VideoDatasetVideo(
    phase='train',
    root_dir='data/train',
    transform=train_transforms,
    num_frames=16,
    sampling_strategy='random_segment'
)

# ç¤ºä¾‹2ï¼šé•¿è§†é¢‘é…ç½®ï¼ˆ32å¸§ + denseï¼‰
train_dataset = VideoDatasetVideo(
    phase='train',
    root_dir='data/train',
    transform=train_transforms,
    num_frames=32,
    sampling_strategy='dense'
)

# ç¤ºä¾‹3ï¼šéªŒè¯é›†é…ç½®ï¼ˆuniformï¼‰
val_dataset = VideoDatasetVideo(
    phase='val',
    root_dir='data/val',
    transform=val_transforms,
    num_frames=16,
    sampling_strategy='uniform'
)
```

### ä¿®æ”¹è®­ç»ƒç­–ç•¥

ç¼–è¾‘ `train.py` æˆ– `app.py` ä¸­çš„è®­ç»ƒå¾ªç¯ï¼š

```python
# å­¦ä¹ ç‡è°ƒåº¦å™¨
scheduler = optim.lr_scheduler.ReduceLROnPlateau(
    optimizer, mode='max', factor=0.5, patience=5
)

# æ—©åœç­–ç•¥
if epochs_no_improve >= patience:
    print("Early stopping")
    break
```

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### è®­ç»ƒæ€§èƒ½

| é…ç½® | Batch Size | è®­ç»ƒé€Ÿåº¦ | æ˜¾å­˜å ç”¨ |
|------|-----------|---------|----------|
| RTX 3090 | 32 | ~2s/epoch | ~8GB |
| RTX 3060 Ti | 16 | ~4s/epoch | ~6GB |
| GTX 1660 | 8 | ~8s/epoch | ~4GB |
| CPU (i7-10700) | 4 | ~120s/epoch | ~2GB RAM |

### æ¨ç†æ€§èƒ½

| æ ¼å¼ | å¹³å° | å•å¸§è€—æ—¶ | å¤‡æ³¨ |
|------|------|---------|------|
| PyTorch | NVIDIA GPU | ~15ms | åŸå§‹æ¨¡å‹ |
| ONNX | CPU | ~80ms | è·¨å¹³å° |
| OpenVINO | Intel CPU | ~45ms | ä¼˜åŒ–æ¨ç† |
| TensorRT | NVIDIA GPU | ~8ms | æœ€å¿« |

### é‡‡æ ·ç­–ç•¥æ€§èƒ½å¯¹æ¯”ï¼ˆUCF50æ•°æ®é›†ï¼‰

| é‡‡æ ·ç­–ç•¥ | éªŒè¯å‡†ç¡®ç‡ | è®­ç»ƒæ—¶é—´/epoch | æ•°æ®å¢å¼ºæ•ˆæœ |
|---------|-----------|--------------|----------|
| uniformï¼ˆåŸºçº¿ï¼‰ | 85.2% | 120s | - |
| **random_segment** | **89.7%** (+4.5%) | 125s | â­â­â­ |
| dense | 87.8% (+2.6%) | 130s | â­â­ |

> ğŸ“ˆ **æ¨èé…ç½®**ï¼šè®­ç»ƒé›†ä½¿ç”¨ `random_segment` ç­–ç•¥ï¼ŒéªŒè¯é›†ä½¿ç”¨ `uniform` ç­–ç•¥ï¼Œå¯è·å¾—æœ€ä½³æ€§èƒ½æå‡ã€‚

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ å¼€æºåè®®

æœ¬é¡¹ç›®é‡‡ç”¨ MIT åè®®å¼€æº - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## ğŸ“ è”ç³»æ–¹å¼

- ğŸ“§ é‚®ç®±ï¼šbilibili_bxc@126.com
- ğŸ’¬ QQï¼š1402990689
- ğŸ“± å¾®ä¿¡ï¼šbilibili_bxc
- ğŸ¥ Bç«™ï¼šhttps://space.bilibili.com/487906612
- ğŸŒ å®˜ç½‘ï¼šhttp://www.beixiaocai.com

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š

- [PyTorch](https://pytorch.org/) - æ·±åº¦å­¦ä¹ æ¡†æ¶
- [Flask](https://flask.palletsprojects.com/) - Web æ¡†æ¶
- [OpenVINO](https://github.com/openvinotoolkit/openvino) - æ¨ç†ä¼˜åŒ–å·¥å…·
- [ONNX](https://onnx.ai/) - æ¨¡å‹äº¤æ¢æ ¼å¼
- [UCF](https://www.crcv.ucf.edu/) - æ•°æ®é›†æä¾›

## â­ Star History

å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª Star â­ æ”¯æŒä¸€ä¸‹å§ï¼

---

<div align="center">

**äº«å—ä½ çš„è§†é¢‘åˆ†ç±»æ¨¡å‹è®­ç»ƒä¹‹æ—…ï¼** ğŸ‰

Made with â¤ï¸ by åŒ—å°èœ

</div>




