# BXC_VideoNet Web 管理后台使用说明

## 📖 简介

BXC_VideoNet Web 管理后台是一个基于 Flask 开发的视频分类模型训练与管理平台，提供数据集管理、模型训练、模型测试等一体化功能。

## 🚀 快速开始

### 1. 安装依赖

首先确保已经安装了项目的基础依赖：

```bash
# 在虚拟环境中安装基础依赖
python -m pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple

# 安装 Flask
python -m pip install flask -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### 2. 启动 Web 服务器

```bash
python app.py
```

启动成功后，在浏览器访问：`http://127.0.0.1:5000`

## 💡 功能使用指南

### 📁 数据集管理（首页）

#### 功能 1：上传训练样本

1. **输入类别名称**：在"类别名称"输入框中输入视频所属的类别（例如：Basketball, Dancing, Running）
2. **选择视频文件**：
   - 点击上传区域选择文件
   - 或直接拖拽视频文件到上传区域
   - 支持多文件批量上传
   - 支持格式：.mp4, .avi, .mov
   - 单个文件最大 500MB
3. **点击"开始上传"**：系统会将视频保存到对应类别的上传目录

**提示**：可以为不同类别分别上传视频，系统会自动管理分类。

#### 功能 2：分割数据集

1. **调整训练集比例**：拖动滑块设置训练集占比（默认 80%）
2. **设置随机种子**：用于保证分割结果可重复（默认 42）
3. **点击"开始分割"**：系统会自动将上传的视频按比例分割为训练集和验证集

**注意**：分割操作会清空现有的训练集和验证集目录！

#### 功能 3：查看数据集统计

页面顶部会实时显示：
- 训练集视频数量
- 验证集视频数量
- 类别总数
- 每个类别的详细统计

### 🚀 模型训练

#### 配置训练参数

1. **训练轮数 (Epochs)**：模型训练的总轮数，建议 50-300
2. **批次大小 (Batch Size)**：每批处理的视频数量
   - GPU 显存较大：可设置 16、32
   - GPU 显存较小：建议 4、8
   - CPU 训练：建议 2、4
3. **学习率 (Learning Rate)**：建议 0.0001-0.001
4. **预训练模型**：
   - 选择"从头开始训练"：全新训练
   - 选择已有模型：断点续训或迁移学习

#### 开始训练

1. 配置完参数后点击"开始训练"
2. 系统会在后台启动训练线程
3. 实时显示训练进度：
   - 当前轮次和总轮次
   - 训练集损失和准确率
   - 验证集损失和准确率
   - 最佳验证准确率
   - 训练日志

#### 停止训练

点击"停止训练"按钮可随时中断训练。系统会保存当前的最新模型状态（latest_model.pth），方便后续继续训练。

#### 模型保存规则

- **最佳模型**：验证准确率超过历史最佳时自动保存，命名格式：`best_model_epoch{轮次}_acc{准确率}.pth`
- **最新模型**：每轮训练后更新 `latest_model.pth`
- 保存位置：`web_data/models/` 目录

### 🧪 模型测试

#### 测试步骤

1. **选择模型**：从下拉列表中选择要测试的模型
2. **上传测试视频**：
   - 点击或拖拽上传视频文件
   - 支持格式：.mp4, .avi, .mov
3. **点击"开始预测"**：系统会自动推理并显示结果

#### 预测结果说明

- **预测类别**：模型判断的视频类别
- **置信度**：预测的可信程度（0-100%）
- **Top 5 预测概率**：前 5 个最可能的类别及其概率，帮助分析模型表现

#### 测试历史

页面会保留最近 10 次测试记录，包括：
- 测试时间
- 视频文件名
- 使用的模型
- 预测结果
- 置信度

## 📂 数据目录结构

```
BXC_VideoNet/
├── app.py                    # Web 服务器主程序
├── templates/                # 页面模板
│   ├── base.html
│   ├── index.html           # 数据集管理
│   ├── train.html           # 模型训练
│   └── test.html            # 模型测试
├── web_data/                # Web 数据目录（自动创建）
│   ├── uploads/             # 上传的视频（按类别分文件夹）
│   ├── dataset/             # 分割后的数据集
│   │   ├── train/           # 训练集
│   │   └── val/             # 验证集
│   ├── models/              # 保存的模型文件
│   └── config.json          # 配置文件
└── ...
```

## ⚙️ 训练建议

### GPU 训练（推荐）

- 确保已安装 CUDA 版本的 PyTorch
- 批次大小可设置较大（8-32）
- 训练速度快，适合大规模训练

### CPU 训练

- 批次大小建议较小（2-8）
- 训练时间较长
- 适合小规模实验

### 数据集准备建议

1. **每个类别至少 20-50 个视频**
2. **视频质量**：清晰、稳定、光线充足
3. **视频长度**：建议 3-10 秒（系统会自动采样 16 帧）
4. **类别平衡**：各类别视频数量尽量接近

### 训练参数调优

- **过拟合**（训练准确率高，验证准确率低）：
  - 减少训练轮数
  - 增加数据增强
  - 使用更多训练数据

- **欠拟合**（训练和验证准确率都低）：
  - 增加训练轮数
  - 调高学习率
  - 检查数据质量

## ❓ 常见问题

### Q1: 上传视频失败？
- 检查文件格式是否为 .mp4, .avi, .mov
- 确认文件大小不超过 500MB
- 检查磁盘空间是否充足

### Q2: 训练过程中显存不足？
- 降低批次大小（Batch Size）
- 关闭其他占用 GPU 的程序

### Q3: 训练很慢？
- 检查是否使用了 GPU（查看训练日志中的设备信息）
- 降低数据加载的 num_workers（修改 app.py）
- 减少训练数据量进行快速实验

### Q4: 如何断点续训？
1. 在训练页面选择之前保存的模型（通常选择 latest_model.pth）
2. 配置训练参数
3. 点击开始训练，系统会从上次的状态继续

## 📞 技术支持

- 作者：北小菜
- 邮箱：bilibili_bxc@126.com
- QQ：1402990689
- 微信：bilibili_bxc
- 哔哩哔哩：https://space.bilibili.com/487906612

## 📝 更新日志

### v1.0.0 (2025-10)
- ✅ 数据集上传与管理
- ✅ 自定义比例分割训练集/验证集
- ✅ 可视化模型训练界面
- ✅ 实时训练进度监控
- ✅ 模型测试与预测
- ✅ 训练历史与模型管理
- ✅ 纯原生实现（无第三方 JS/CSS 库）

---

**享受你的视频分类模型训练之旅！** 🎉
